---
domain: www.integral-therapy.com
cdn: www.integral-therapy.com
uid: 1 # The CAPE user ID to use for authenticating against the providers when requesting resources.
cape_version: 2.2.2

load:
  - "/_api/content/_load.json"

api: # An API is just a set of default information.
  content: # Machine name. This is where most of our content should live.
    provider: github
    arg:
      repo: integral-therapy
      owner: sundaysenergy
    field:
      dir_i: true
      filename: true
    fields:
      -
        filter:
          must:
            dir1: staff
          should:
            ext: ['.jpg', '.png', '.gif', '.jpeg']
          field:
            _file:
              thumb:
                path: '{{dirname}}/{{filename}}_thumb{{ext}}'
      -
        filter:
          must:
            dirname: staff
            ext: '.md'
        default:
          sort: 0

    img_size:
      sizes:
        thumb:
          width: 155
          height: 155

model:
  data:
    api: content
    get: data.yaml

  navigation:
    api: content
    get: navigation.yaml
    pluck: navigation

  staff_pics:
    api: content
    must:
      dir1: staff
    must_not:
      ext: .md

  md_staff: # A listing of staff profiles.
    api: content
    must:
      dirname: staff
      ext: .md
    sort: sort

    # file:
    #   source_file:
    #     api: content
    #     file_id: 'staff/original/{{photo}}'
    #     resource: raw
    #     type: any
    #     arg:
    #       path: 'staff/{{photo}}'
    #     img_size:
    #       overwrite: true
    #       delete_source: true
    #       cdn: false
    #       sizes:
    #         -
    #           destination: 'staff/{{photo}}'
    #           width: '115'
    #           height: '155'
    #           name: normal
    #           save_size: true
    # sort: # Define how to sort the view entities.
    #   field: sort # Look for the order field.
    #   default: 1 # Default sort value.
    #   order: ascending

  md_pages:
    api: content
    must:
      ext: .md
    empty_fields: dirname

view:
  staff: # the machine name of the display.
    file_id: credentials_stub.html
    field:
      data: true
      md_staff: true
    template: # The page style requires the template attribute.
      api: content
      get: theme/layouts/staff.html

  wufoo:
    file_id: contact_stub.html
    field:
      data: true
    template:
      api: content
      get: theme/layouts/wufoo.html

  # navigation: # Machine name of the display.
  #   file_id: navigation.html
  #   field:
  #     navigation: true
  #   template: # The page style requires the template attribute.
  #     api: content # Where do we get the layout file from?
  #     get: theme/layouts/navigation.html # What ID does the layout file have?

  staff_index:
    file_id: credentials.html
    field: # You can add fields to a specific display. These fields are not available during filtering.
      content: true
      data: true # Define the field data as...
      navigation: true # The navigation variable will be the output from the default display on the navigation view.
    template: # Send the field variables through the mustache converter.
      api: content
      get: theme/layouts/default.html

  pages:
    field:
      data: true
      wufoo: true
    pager:
      iterate: md_pages
      field_id: page
      file_id: '{{&page.no_ext}}.html'
    template:
      api: content
      get: theme/layouts/default.html

