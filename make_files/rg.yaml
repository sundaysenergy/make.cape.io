---
domain: templates.cape.io # This is the cache CNAME used for the virtual server on the compile server. CNAME that domain to cache.cape.io and it will serve the compiled website.
uid: 1 # The CAPE user ID to use for authenticating against the providers when requesting API resources. This needs to be updated to the correct uid.
cape_version: 2.0.3 # Current version of cape can be found at v2.api.cape.io/version

api: # An API is a set of default information. Think of an API as a collection of content.
  old_demo: # Used to get content from github.
    provider: github
    arg:
      owner: ookb
      repo: rogersgoffigon
      branch: gh-pages
    load: # To load previously created content from this API you need to specificy the load param.
      resource: tree # Github has a nice index of all content in a repo.
      _id: path
      arg:
        recursive: true # Thankfully they have an option to get results recursively.
        sha: gh-pages
  gh_repo: # Used to get content from github.
    provider: github
    arg:
      owner: bjornmeansbear
      repo: rogers-and-goffigon
      branch: master
    load:
      resource: tree
      _id: path
      arg:
        recursive: true
        sha: master
    # load: # To load previously created content from this API you need to specificy the load param.
    #   api: wget
    #   resource: raw # Github has a nice index of all content in a repo.
    #   type: json
    #   _id: itemnum
    #   arg:
    #     url: 'reference/randglist/randg_price.json'
  # An API defined for accepting posts
  items:
    provider: post
    arg:
      id: rg
      source: pdf_csv
    load: false

model:

  files:
    type: files
    filter:
      api: gh_repo
      should:
        _ext: ['.jpg', '.jpeg', '.png', '.css', '.js', '.ico', '.gif', '.html', '.ttf']
      must_not:
        _dir1: reference
    field:
      _file:
        api: gh_repo
        resource: raw_api
        file_id: '{{&_id}}'
        type: any
        arg:
          path: '{{&_id}}'

  textile:
    type: list
    filter:
      api: items
      must:
        _char1int: true
  passementerie:
    type: list
    filter:
      api: items
      must:
        _char1: P
  leather:
    type: list
    filter:
      api: items
      must:
        _char1: L

  # admin:
  #   type: files
  #   filter:
  #     api: gh_repo
  #     must:
  #       _dir1: admin
  #   field:
  #     _file:
  #       file_id: '{{&_id}}'
  #       api: gh_repo
  #       resource: raw_api
  #       type: any
  #       arg:
  #         path: '{{&_id}}'

  images:
    type: files
    filter:
      api: images
    field: # original file.
      normal:
        file_id: 'items/{{&itemnum}}/normal.jpg'
      normal_320:
        file_id: 'items/{{&itemnum}}/320/normal.jpg'
      normal_640:
        file_id: 'items/{{&itemnum}}/640/normal.jpg'
      normal_1024:
        file_id: 'items/{{&itemnum}}/1024/normal.jpg'
      normal_1536:
        file_id: 'items/{{&itemnum}}/1536/normal.jpg'
      far:
        file_id: 'items/{{&itemnum}}/far.jpg'
      far_320:
        file_id: 'items/{{&itemnum}}/320/far.jpg'
      far_640:
        file_id: 'items/{{&itemnum}}/640/far.jpg'
      far_1024:
        file_id: 'items/{{&itemnum}}/1024/far.jpg'
      far_1536:
        file_id: 'items/{{&itemnum}}/1536/far.jpg'

